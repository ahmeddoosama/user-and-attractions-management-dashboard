import{a as rt}from"./chunk-F7IK6PHN.js";import{A as Ht,a as xt,b as $,c as St,d as z,e as vt,f as At,g as Mt,h as yt,i as bt,j as Et,k as wt,l as Tt,m as Dt,n as It,o as kt,p as Lt,q as Rt,r as Ft,s as jt,t as Ot,u as Pt,v as Nt,w as Ut,x as qt,y as $t,z as zt}from"./chunk-O3MFJT2T.js";import{b as at}from"./chunk-ETMCZ2Y3.js";import{A as Ct,B as gt,C as H,D as V,E as Vt,F as Bt,e as j,f as O,g as lt,h as mt,j as ct,m as P,n as N,o as U,p as x,r as q,s as st,t as dt,v as pt,w as ut,x as ft,y as _t,z as ht}from"./chunk-LD5UOIZG.js";import{O as k,Q as L,R,la as F,ma as ot}from"./chunk-5SWDGQ7Z.js";import"./chunk-3LVY4AV7.js";import{Ab as n,Bb as a,Cb as f,Db as S,Eb as v,G as X,Gb as Q,Jb as C,L as Y,Lb as d,M as y,Pb as W,Qb as J,Rb as K,Sb as it,Tb as m,Ub as nt,Vb as A,W as G,Wa as et,Yb as I,Za as c,_a as g,aa as Z,fa as tt,j as E,la as w,pb as s,rb as _,va as T,wa as D,wb as u}from"./chunk-RF7UUZCQ.js";var b=(()=>{class e{static{this.baseUrl="api/attractions"}static{this.creationUrl="api/auth/attractions"}static get BaseUrl(){return this.baseUrl}static get CreateUrl(){return`${this.creationUrl}/create`}static get UpdateUrl(){return`${this.creationUrl}/update`}static get DeleteUrl(){return`${this.baseUrl}/delete`}}return e})();var B=(()=>{class e{constructor(t){this.coreRequest=t}getAttractions(t,o,i,l,p){let h={};return h.page=t??1,h.per_page=o??10,i&&(h.search=i),l&&(h.sort_column=l),p&&(h.sort_order=p),this.coreRequest.get(b.BaseUrl,h)}getAttraction(t){return this.coreRequest.get(`${b.BaseUrl}/${t}`)}createAttraction(t){return this.coreRequest.post(t,b.CreateUrl)}updateAttraction(t){return this.coreRequest.put(t,b.UpdateUrl)}deleteAttraction(t){let o={id:t};return this.coreRequest.delete(o,b.DeleteUrl)}static{this.\u0275fac=function(o){return new(o||e)(tt(ot))}}static{this.\u0275prov=Z({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function ie(e,r){e&1&&(n(0,"span"),m(1,"Name is required"),a())}function ne(e,r){e&1&&(n(0,"span"),m(1,"Name must be at least 2 characters"),a())}function ae(e,r){e&1&&(n(0,"span"),m(1,"Name must be at most 100 characters"),a())}function oe(e,r){if(e&1&&(n(0,"mat-error"),s(1,ie,2,0,"span")(2,ne,2,0)(3,ae,2,0),a()),e&2){let t,o=d();c(),u(1,!((t=o.form.get("name"))==null||t.errors==null)&&t.errors.required?1:!((t=o.form.get("name"))==null||t.errors==null)&&t.errors.minlength?2:!((t=o.form.get("name"))==null||t.errors==null)&&t.errors.maxlength?3:-1)}}function re(e,r){e&1&&(n(0,"span"),m(1,"Detail is required"),a())}function le(e,r){if(e&1&&(n(0,"mat-error"),s(1,re,2,0,"span"),a()),e&2){let t,o=d();c(),u(1,!((t=o.form.get("detail"))==null||t.errors==null)&&t.errors.required?1:-1)}}function me(e,r){e&1&&(n(0,"span"),m(1,"Latitude is required"),a())}function ce(e,r){if(e&1&&(n(0,"mat-error"),s(1,me,2,0,"span"),a()),e&2){let t,o=d();c(),u(1,!((t=o.form.get("latitude"))==null||t.errors==null)&&t.errors.required?1:-1)}}function se(e,r){e&1&&(n(0,"span"),m(1,"Longitude is required"),a())}function de(e,r){if(e&1&&(n(0,"mat-error"),s(1,se,2,0,"span"),a()),e&2){let t,o=d();c(),u(1,!((t=o.form.get("longitude"))==null||t.errors==null)&&t.errors.required?1:-1)}}function pe(e,r){e&1&&f(0,"mat-spinner",15)}function ue(e,r){if(e&1&&m(0),e&2){let t=d();A(" ",t.type==="create"?"Create":"Update"," ")}}var Wt=(()=>{class e{constructor(t,o,i,l,p){this.fb=t,this.attractionsService=o,this.notification=i,this.dialogRef=l,this.isLoading=!1,this.type="create",this.destroy$=new E,this.type=p?.type||"create",this.attraction=p?.attraction,this.form=this.initForm(this.attraction)}initForm(t){return this.fb.group({name:[t?.name??"",[x.required,x.minLength(2),x.maxLength(100)]],detail:[t?.detail??"",[x.required,x.minLength(2)]],latitude:[t?.latitude??"",[x.required]],longitude:[t?.longitude??"",[x.required]]})}_keyPress(t){return new rt().validateNumericInput(t)}onSubmit(){if(this.form.valid){let t=this.form.value;this.type==="create"?(t.coverimage="https://www.melivecode.com/attractions/12.jpg",this.createAttraction(t)):(t.id=this.attraction?.id,this.updateAttraction(t))}else this.markFormGroupTouched(this.form)}createAttraction(t){this.isLoading=!0,this.attractionsService.createAttraction(t).pipe(G(this.destroy$),y(()=>this.isLoading=!1)).subscribe({next:()=>{this.notification.success("Attraction created successfully"),this.dialogRef.close(!0)},error:o=>{let i=o?.error?.message;this.notification.error(i)}})}updateAttraction(t){this.isLoading=!0,this.attractionsService.updateAttraction(t).pipe(G(this.destroy$),y(()=>this.isLoading=!1)).subscribe({next:()=>{this.notification.success("Attraction updated successfully"),this.dialogRef.close(!0)}})}markFormGroupTouched(t){Object.values(t.controls).forEach(o=>{o.markAsTouched(),o instanceof dt&&this.markFormGroupTouched(o)})}onCancel(){this.dialogRef.close(!1)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static{this.\u0275fac=function(o){return new(o||e)(g(ht),g(B),g(F),g(qt),g($t,8))}}static{this.\u0275cmp=w({type:e,selectors:[["app-create-edit-attraction"]],standalone:!0,features:[I],decls:36,vars:10,consts:[[1,"flex","items-center","justify-between","py-2","px-4","border-b","border-lavenderMist"],[1,"text-ebonyClay","font-medium","text-base"],["mat-icon-button","",1,"close-icon",3,"click","disabled"],[1,"px-4","py-6"],[1,"w-full","md:w-96","flex","flex-col","items-center","justify-center",3,"formGroup"],[1,"w-full"],["matInput","","type","text","formControlName","name","placeholder","Enter your name"],[1,"w-full","text-area-field"],["matInput","","formControlName","detail","placeholder","Enter your detail"],[1,"flex","flex-col","md:flex-row","md:gap-4","w-full"],["matInput","","type","text","formControlName","latitude","placeholder","Enter your latitude",3,"keypress"],["matInput","","type","text","formControlName","longitude","placeholder","Enter your longitude",3,"keypress"],[1,"flex","items-center","justify-end","gap-4","py-4","px-6","border","border-t","border-lavenderMist"],["mat-raised-button","",1,"discard-button",3,"click","disabled"],["mat-raised-button","",1,"confirm-button",3,"click","disabled"],["strokeWidth","10",1,"form-spinner"]],template:function(o,i){if(o&1&&(n(0,"div")(1,"div",0)(2,"div",1),m(3),a(),n(4,"button",2),C("click",function(){return i.onCancel()}),n(5,"mat-icon"),m(6,"close"),a()()(),n(7,"div",3)(8,"form",4)(9,"mat-form-field",5)(10,"mat-label"),m(11,"Name"),a(),f(12,"input",6),s(13,oe,4,1,"mat-error"),a(),n(14,"mat-form-field",7)(15,"mat-label"),m(16,"Detail"),a(),f(17,"textarea",8),s(18,le,2,1,"mat-error"),a(),n(19,"div",9)(20,"mat-form-field",5)(21,"mat-label"),m(22,"Latitude"),a(),n(23,"input",10),C("keypress",function(p){return i._keyPress(p)}),a(),s(24,ce,2,1,"mat-error"),a(),n(25,"mat-form-field",5)(26,"mat-label"),m(27,"Longitude"),a(),n(28,"input",11),C("keypress",function(p){return i._keyPress(p)}),a(),s(29,de,2,1,"mat-error"),a()()()(),n(30,"div",12)(31,"button",13),C("click",function(){return i.onCancel()}),m(32,"Cancel"),a(),n(33,"button",14),C("click",function(){return i.onSubmit()}),s(34,pe,1,0,"mat-spinner",15)(35,ue,1,1),a()()()),o&2){let l,p,h,M;c(3),nt(i.type==="create"?"Create Attraction":"Update Attraction"),c(),_("disabled",i.isLoading),c(4),_("formGroup",i.form),c(5),u(13,(l=i.form.get("name"))!=null&&l.invalid&&((l=i.form.get("name"))!=null&&l.dirty||(l=i.form.get("name"))!=null&&l.touched)?13:-1),c(5),u(18,(p=i.form.get("detail"))!=null&&p.invalid&&((p=i.form.get("detail"))!=null&&p.dirty||(p=i.form.get("detail"))!=null&&p.touched)?18:-1),c(6),u(24,(h=i.form.get("latitude"))!=null&&h.invalid&&((h=i.form.get("latitude"))!=null&&h.dirty||(h=i.form.get("latitude"))!=null&&h.touched)?24:-1),c(5),u(29,(M=i.form.get("longitude"))!=null&&M.invalid&&((M=i.form.get("longitude"))!=null&&M.dirty||(M=i.form.get("longitude"))!=null&&M.touched)?29:-1),c(2),_("disabled",i.isLoading),c(2),_("disabled",i.form.invalid||i.isLoading),c(),u(34,i.isLoading?34:35)}},dependencies:[gt,ut,U,q,st,ft,_t,V,H,P,lt,mt,N,O,j,R,k,L,Bt,Vt],styles:["[_nghost-%COMP%]     .text-area-field .mdc-text-field--filled{max-height:150px;min-height:100px!important}[_nghost-%COMP%]     .form-spinner{width:20px!important;height:20px!important}[_nghost-%COMP%]     .form-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:#153e66}"]})}}return e})();function fe(e,r){e&1&&(n(0,"mat-header-cell",26),m(1," Image "),a())}function _e(e,r){if(e&1&&f(0,"img",27),e&2){let t=d().$implicit;_("src",t.coverimage,et)}}function he(e,r){e&1&&f(0,"div",28)}function Ce(e,r){if(e&1&&(n(0,"mat-cell",26),s(1,_e,1,1,"img",27)(2,he,1,0),a()),e&2){let t=d();c(),u(1,t.isLoading?2:1)}}function ge(e,r){if(e&1){let t=Q();n(0,"mat-header-cell")(1,"mat-form-field",29)(2,"input",30),C("ngModelChange",function(i){T(t);let l=d();return D(l.onSearchChange(i))}),a(),n(3,"div",31)(4,"div")(5,"mat-icon"),m(6,"search"),a()(),n(7,"div",32)(8,"mat-icon"),m(9,"sort_by_alpha"),a()()()()()}if(e&2){let t=d();c(2),_("ngModel",t.nameSearch)}}function xe(e,r){if(e&1&&m(0),e&2){let t=d().$implicit;A(" ",t.name," ")}}function Se(e,r){e&1&&f(0,"div",33)}function ve(e,r){if(e&1&&(n(0,"mat-cell"),s(1,xe,1,1)(2,Se,1,0),a()),e&2){let t=d();c(),u(1,t.isLoading?2:1)}}function Ae(e,r){e&1&&(n(0,"mat-header-cell",34),m(1," Detail "),a())}function Me(e,r){if(e&1&&(n(0,"div",35),m(1),a()),e&2){let t=d().$implicit;c(),A(" ",t.detail," ")}}function ye(e,r){e&1&&f(0,"div",36)}function be(e,r){if(e&1&&(n(0,"mat-cell"),s(1,Me,2,1,"div",35)(2,ye,1,0),a()),e&2){let t=d();c(),u(1,t.isLoading?2:1)}}function Ee(e,r){e&1&&(n(0,"mat-header-cell",37),m(1," Latitude "),a())}function we(e,r){if(e&1&&m(0),e&2){let t=d().$implicit;A(" ",t.latitude," ")}}function Te(e,r){e&1&&f(0,"div",36)}function De(e,r){if(e&1&&(n(0,"mat-cell"),s(1,we,1,1)(2,Te,1,0),a()),e&2){let t=d();c(),u(1,t.isLoading?2:1)}}function Ie(e,r){e&1&&(n(0,"mat-header-cell",38),m(1," Longitude "),a())}function ke(e,r){if(e&1&&m(0),e&2){let t=d().$implicit;A(" ",t.longitude," ")}}function Le(e,r){e&1&&f(0,"div",36)}function Re(e,r){if(e&1&&(n(0,"mat-cell"),s(1,ke,1,1)(2,Le,1,0),a()),e&2){let t=d();c(),u(1,t.isLoading?2:1)}}function Fe(e,r){e&1&&f(0,"mat-header-cell",39)}function je(e,r){if(e&1){let t=Q();n(0,"button",40)(1,"mat-icon"),m(2,"more_vert"),a()(),n(3,"mat-menu",41,0)(5,"button",42),C("click",function(){T(t);let i=d().$implicit,l=d();return D(l.attractionDialog("edit",i))}),n(6,"mat-icon"),m(7,"edit"),a(),n(8,"span"),m(9,"Edit"),a()(),n(10,"button",42),C("click",function(){T(t);let i=d().$implicit,l=d();return D(l.confirmDelete(i))}),n(11,"mat-icon",43),m(12,"delete"),a(),n(13,"span",44),m(14,"Delete"),a()()()}if(e&2){let t=it(4);_("matMenuTriggerFor",t)}}function Oe(e,r){e&1&&f(0,"div",45)}function Pe(e,r){if(e&1&&(n(0,"mat-cell",39),s(1,je,15,1)(2,Oe,1,0),a()),e&2){let t=d();c(),u(1,t.isLoading?2:1)}}function Ne(e,r){e&1&&f(0,"mat-header-row")}function Ue(e,r){e&1&&f(0,"mat-row")}function qe(e,r){e&1&&(n(0,"tr")(1,"td")(2,"div",46),f(3,"img",47),n(4,"span",48),m(5,"No data matching the filter"),a()()()())}var Si=(()=>{class e{constructor(t,o,i,l){this.attractionsService=t,this.notification=o,this.paginatorIntl=i,this.dialog=l,this.displayedColumns=["coverimage","name","detail","latitude","longitude","actions"],this.isLoading=!1,this.attractions=[],this.total=0,this.currentPage=1,this.pageSize=10,this.pageSizeOptions=[5,10,25,50],this.sortColumn="",this.sortOrder="asc",this.isEmpty=!1,this.nameSearch="",this.searchSubject=new E,this.skeletonData=Array(10).fill({coverimage:"",name:"",detail:"",location:""}),this.paginatorIntl.itemsPerPageLabel="Items per page:",this.searchSubject.pipe(X(300),Y()).subscribe(p=>{this.nameSearch=p,this.currentPage=1,this.paginator&&this.paginator.firstPage(),this.getAttractions()})}ngOnInit(){this.getAttractions()}pageEvent(t){this.currentPage=t.pageIndex+1,this.pageSize=t.pageSize,this.getAttractions()}sortData(t){!t.active||t.direction===""?(this.sortColumn="",this.sortOrder="asc"):(this.sortColumn=t.active,this.sortOrder=t.direction),this.getAttractions()}getAttractions(){this.isLoading=!0,this.attractionsService.getAttractions(this.currentPage,this.pageSize,this.nameSearch,this.sortColumn,this.sortOrder).pipe(y(()=>{this.isLoading=!1})).subscribe({next:t=>{t&&(this.attractions=t.data,this.dataSource=new jt(this.attractions),this.total=t.total,this.isEmpty=this.attractions.length>=10)},error:t=>{let o=t?.error?.message;this.notification.error(o)}})}attractionDialog(t,o){this.dialog.open(Wt,{data:{type:t,attraction:o},panelClass:"create-edit-user-dialog"}).afterClosed().subscribe(l=>{l&&this.getAttractions()})}confirmDelete(t){this.dialog.open(Ht,{data:{title:"Delete Attraction",message:"Are you sure you want to delete this attraction?"},panelClass:"confirmation-dialog"}).afterClosed().subscribe(i=>{i&&this.deleteAttraction(t)})}deleteAttraction(t){this.isLoading=!0,this.attractionsService.deleteAttraction(t.id).pipe(y(()=>{this.isLoading=!1})).subscribe({next:()=>{this.notification.success(`${t.name} deleted successfully`),this.getAttractions()},error:o=>{let i=o?.error?.message;this.notification.error(i)}})}onSearchChange(t){this.searchSubject.next(t)}static{this.\u0275fac=function(o){return new(o||e)(g(B),g(F),g(xt),g(zt))}}static{this.\u0275cmp=w({type:e,selectors:[["app-attractions"]],viewQuery:function(o,i){if(o&1&&(W($,5),W(z,5)),o&2){let l;J(l=K())&&(i.paginator=l.first),J(l=K())&&(i.sort=l.first)}},standalone:!0,features:[I],decls:33,vars:10,consts:[["menu","matMenu"],["actions","",1,"flex","items-center"],["mat-button","",1,"action-button",3,"click"],[1,"w-full","relative"],[1,"overflow-x-auto","w-full",2,"max-width","calc(100vw - 32px)"],[1,"mat-elevation-z8","min-w-[1000px]"],["matSort","",3,"matSortChange","dataSource","matSortActive","matSortDirection"],["matColumnDef","coverimage",3,"sticky"],["class","!w-40 !max-w-40",4,"matHeaderCellDef"],["class","!w-40 !max-w-40",4,"matCellDef"],["matColumnDef","name"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","detail"],["mat-sort-header","detail",4,"matHeaderCellDef"],["matColumnDef","latitude"],["mat-sort-header","latitude",4,"matHeaderCellDef"],["matColumnDef","longitude"],["mat-sort-header","longitude",4,"matHeaderCellDef"],["matColumnDef","actions"],["class","!w-20 !max-w-20 justify-center",4,"matHeaderCellDef"],["class","!w-20 !max-w-20 justify-center",4,"matCellDef"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[4,"matNoDataRow"],["aria-label","Select page",3,"page","length","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"!w-40","!max-w-40"],["alt","attraction cover image","loading","lazy",1,"w-20","h-20","rounded-md",3,"src"],[1,"my-2","w-20","h-20","rounded-md","bg-gray-200","animate-pulse"],[1,"search-input","max-w-40"],["matInput","","placeholder","Name",3,"ngModelChange","ngModel"],["matSuffix","",1,"flex","items-center","gap-2"],["mat-sort-header","name","arrowPosition","after"],[1,"h-4","bg-gray-200","rounded","w-32","animate-pulse"],["mat-sort-header","detail"],[1,"py-2","w-44","max-w-44"],[1,"h-4","bg-gray-200","rounded","w-24","animate-pulse"],["mat-sort-header","latitude"],["mat-sort-header","longitude"],[1,"!w-20","!max-w-20","justify-center"],["mat-icon-button","",3,"matMenuTriggerFor"],[1,"-mt-5"],["mat-menu-item","",3,"click"],[1,"!text-cardinal"],[1,"text-cardinal"],[1,"h-8","w-8","bg-gray-200","rounded-full","animate-pulse"],[1,"w-screen","max-w-[100vh]","min-h-[500px]","flex","flex-col","items-center","justify-center"],["src","assets/images/empty-data.png","alt","No data",1,"w-64"],[1,"text-cardinal","font-medium","text-base","mt-4"]],template:function(o,i){o&1&&(n(0,"app-container")(1,"div",1)(2,"button",2),C("click",function(){return i.attractionDialog("create")}),n(3,"mat-icon"),m(4,"add"),a(),n(5,"span"),m(6,"Add Attraction"),a()()(),n(7,"div",3)(8,"div",4)(9,"div",5)(10,"mat-table",6),C("matSortChange",function(p){return i.sortData(p)}),S(11,7),s(12,fe,2,0,"mat-header-cell",8)(13,Ce,3,1,"mat-cell",9),v(),S(14,10),s(15,ge,10,1,"mat-header-cell",11)(16,ve,3,1,"mat-cell",12),v(),S(17,13),s(18,Ae,2,0,"mat-header-cell",14)(19,be,3,1,"mat-cell",12),v(),S(20,15),s(21,Ee,2,0,"mat-header-cell",16)(22,De,3,1,"mat-cell",12),v(),S(23,17),s(24,Ie,2,0,"mat-header-cell",18)(25,Re,3,1,"mat-cell",12),v(),S(26,19),s(27,Fe,1,0,"mat-header-cell",20)(28,Pe,3,1,"mat-cell",21),v(),s(29,Ne,1,0,"mat-header-row",22)(30,Ue,1,0,"mat-row",23)(31,qe,6,0,"tr",24),a(),n(32,"mat-paginator",25),C("page",function(p){return i.pageEvent(p)}),a()()()()()),o&2&&(c(10),_("dataSource",i.isLoading?i.skeletonData:i.dataSource)("matSortActive",i.sortColumn)("matSortDirection",i.sortOrder),c(),_("sticky",!1),c(18),_("matHeaderRowDef",i.displayedColumns),c(),_("matRowDefColumns",i.displayedColumns),c(2),_("length",i.total)("pageSize",i.pageSize)("pageSizeOptions",i.pageSizeOptions)("showFirstLastButtons",!0))},dependencies:[Ct,U,q,pt,R,k,L,O,j,Ft,Mt,bt,Dt,Et,yt,It,wt,Tt,kt,Lt,Rt,St,$,At,z,vt,N,P,ct,V,H,Ut,Pt,Ot,Nt,at],styles:["[_nghost-%COMP%]     .search-input{padding-bottom:1rem}[_nghost-%COMP%]     .search-input .mdc-text-field--filled{height:50px}[_nghost-%COMP%]     .search-input .mat-mdc-form-field-subscript-wrapper{display:none}[_nghost-%COMP%]     .search-input .mat-icon{width:20px!important;height:20px!important}[_nghost-%COMP%]     .search-input .material-icons{font-size:20px!important}.mat-mdc-table[_ngcontent-%COMP%]{width:100%}"]})}}return e})();export{Si as AttractionsComponent};
