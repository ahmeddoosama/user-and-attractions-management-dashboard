import{c as M,g as I}from"./chunk-GGLDWHXY.js";import{B as H,C as J,D as K,E as Q,F as X,e as P,f as j,g as q,h as G,j as O,m as A,n as N,o as U,p as f,r as B,s as D,t as R,w as V,x as z,y as W,z as $}from"./chunk-LD5UOIZG.js";import{O as E,Q as L,R as k,la as T,ma as F}from"./chunk-5SWDGQ7Z.js";import"./chunk-3LVY4AV7.js";import{Ab as n,Bb as o,Cb as h,Jb as p,Lb as _,M as v,Tb as a,Ub as x,Yb as y,Za as l,_a as d,aa as C,fa as S,la as b,pb as c,qb as w,rb as g,wb as m}from"./chunk-RF7UUZCQ.js";var Y=(()=>{class e{static{this.baseUrl="api/login"}static get BaseUrl(){return this.baseUrl}}return e})();var Z=(()=>{class e{constructor(t){this.coreRequest=t}signIn(t){return this.coreRequest.post(t,Y.BaseUrl)}static{this.\u0275fac=function(r){return new(r||e)(S(F))}}static{this.\u0275prov=C({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function ne(e,s){e&1&&(n(0,"span"),a(1,"Email is required"),o())}function oe(e,s){e&1&&(n(0,"span"),a(1,"Invalid email format"),o())}function re(e,s){if(e&1&&(n(0,"mat-error"),c(1,ne,2,0,"span")(2,oe,2,0,"span"),o()),e&2){let t=_();l(),m(1,!(t.username==null||t.username.errors==null)&&t.username.errors.required?1:-1),l(),m(2,!(t.username==null||t.username.errors==null)&&t.username.errors.username?2:-1)}}function ae(e,s){e&1&&(n(0,"span"),a(1,"Password is required"),o())}function le(e,s){e&1&&(n(0,"span"),a(1,"Password must be at least 6 characters"),o())}function se(e,s){if(e&1&&(n(0,"mat-error"),c(1,ae,2,0,"span")(2,le,2,0,"span"),o()),e&2){let t=_();l(),m(1,!(t.password==null||t.password.errors==null)&&t.password.errors.required?1:-1),l(),m(2,!(t.password==null||t.password.errors==null)&&t.password.errors.minlength?2:-1)}}function me(e,s){e&1&&h(0,"mat-spinner",11)}function de(e,s){e&1&&(n(0,"span"),a(1,"Login"),o())}var Ie=(()=>{class e{constructor(t,r,i,u,ee){this.fb=t,this.authService=r,this.notification=i,this.storageService=u,this.router=ee,this.hide=!0,this.isLoading=!1,this.form=this.initForm()}initForm(){return this.fb.group({username:["",[f.required,f.email]],password:["",[f.required,f.minLength(10)]]})}onSubmit(){if(this.form.valid){this.isLoading=!0;let t=this.form.value;this.login(t)}else this.markFormGroupTouched(this.form)}login(t){this.authService.signIn(t).pipe(v(()=>{this.isLoading=!1})).subscribe({next:r=>{r&&(this.storageService.setToken(r.accessToken),this.storageService.setAdmin(r.user),this.router.navigate(["/dashboard"]),this.notification.success(`Welcome Back ${r.user.fname} ${r.user.lname} !`))},error:r=>{let i=r?.error?.message;this.notification.error(i)}})}markFormGroupTouched(t){Object.values(t.controls).forEach(r=>{r.markAsTouched(),r instanceof R&&this.markFormGroupTouched(r)})}copyUsername(){navigator.clipboard.writeText("karn.yong@melivecode.com"),this.form.controls.username.setValue("karn.yong@melivecode.com")}copyPassword(){navigator.clipboard.writeText("melivecode"),this.form.controls.password.setValue("melivecode")}get username(){return this.form.get("username")}get password(){return this.form.get("password")}static{this.\u0275fac=function(r){return new(r||e)(d($),d(Z),d(T),d(I),d(M))}}static{this.\u0275cmp=b({type:e,selectors:[["app-login"]],standalone:!0,features:[y],decls:37,vars:9,consts:[[1,"h-full","bg-porcelain","flex","flex-col","items-center","justify-center","p-6"],[1,"p-4","h-screen-minus-20","w-full","flex","items-center","justify-center","flex-col","gap-4","bg-white","border","border-lavenderMist","rounded-lg","shadow-card"],[1,"flex","items-center","flex-col","gap-2"],[1,"text-ebonyClay","text-4xl","font-bold"],[1,"text-center","text-davyGrey"],[1,"w-full","md:w-96","flex","flex-col","items-center","justify-center",3,"ngSubmit","formGroup"],[1,"w-full"],["matInput","","type","email","formControlName","username","placeholder","Enter your email"],["matInput","","placeholder","Enter your password","formControlName","password",3,"type"],["mat-icon-button","","matSuffix","",3,"click"],["mat-raised-button","",1,"secondary-button","mt-4",3,"disabled"],["strokeWidth","10"],[1,"flex","items-center","flex-col","gap-1","mt-5"],[1,"text-gray-500"],[1,"flex","items-center","gap-2"],[1,"text-sm","md:text-base","text-gray-500"],[1,"cursor-pointer",3,"click"]],template:function(r,i){r&1&&(n(0,"section",0)(1,"div",1)(2,"div",2)(3,"h2",3),a(4,"Login"),o(),n(5,"p",4),a(6,"Please enter your email and password to login."),o()(),n(7,"form",5),p("ngSubmit",function(){return i.onSubmit()}),n(8,"mat-form-field",6)(9,"mat-label"),a(10,"Email"),o(),h(11,"input",7),c(12,re,3,2,"mat-error"),o(),n(13,"mat-form-field",6)(14,"mat-label"),a(15,"Password"),o(),h(16,"input",8),n(17,"button",9),p("click",function(){return i.hide=!i.hide}),n(18,"mat-icon"),a(19),o()(),c(20,se,3,2,"mat-error"),o(),n(21,"button",10),c(22,me,1,0,"mat-spinner",11)(23,de,2,0),o()(),n(24,"div",12)(25,"h2",13),a(26,"Account for testing"),o(),n(27,"div",14)(28,"p",15),a(29,"Uername: karn.yong@melivecode.com"),o(),n(30,"mat-icon",16),p("click",function(){return i.copyUsername()}),a(31,"content_copy"),o()(),n(32,"div",14)(33,"p",15),a(34,"Password: melivecode"),o(),n(35,"mat-icon",16),p("click",function(){return i.copyPassword()}),a(36,"content_copy"),o()()()()()),r&2&&(l(7),g("formGroup",i.form),l(5),m(12,i.username!=null&&i.username.invalid&&(i.username!=null&&i.username.dirty||i.username!=null&&i.username.touched)?12:-1),l(4),g("type",i.hide?"password":"text"),l(),w("aria-label","Hide password")("aria-pressed",i.hide),l(2),x(i.hide?"visibility_off":"visibility"),l(),m(20,i.password!=null&&i.password.invalid&&(i.password!=null&&i.password.dirty||i.password!=null&&i.password.touched)?20:-1),l(),g("disabled",i.form.invalid||i.isLoading),l(),m(22,i.isLoading?22:23))},dependencies:[H,V,U,B,D,z,W,K,J,A,q,G,O,N,j,P,k,E,L,X,Q],styles:["[_nghost-%COMP%]   .mat-icon[_ngcontent-%COMP%]{height:1.25rem!important;width:1.25rem!important}[_nghost-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:1.25rem;line-height:1.75rem;line-height:1}[_nghost-%COMP%]   .mat-mdc-progress-spinner[_ngcontent-%COMP%]{width:20px!important;height:20px!important}[_nghost-%COMP%]     .mat-mdc-progress-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:#153e66}"]})}}return e})();export{Ie as LoginComponent};
