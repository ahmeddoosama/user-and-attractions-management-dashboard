import{A as Ae,a as Ce,b as $,c as xe,d as A,e as Se,f as ve,g as Ue,h as Me,i as be,j as ye,k as we,l as Ee,m as De,n as Te,o as Ie,p as Fe,q as Le,r as Re,s as ke,t as je,u as Oe,v as Pe,w as Ne,x as qe,y as ze,z as $e}from"./chunk-O3MFJT2T.js";import{b as re}from"./chunk-ETMCZ2Y3.js";import{A as he,B as ge,C as V,D as B,E as Ve,F as Be,e as j,f as O,g as oe,h as le,j as se,m as P,n as N,o as q,p as x,r as z,s as me,t as ce,v as de,w as ue,x as pe,y as fe,z as _e}from"./chunk-LD5UOIZG.js";import{O as F,Q as L,R,la as k,ma as ae}from"./chunk-5SWDGQ7Z.js";import{Ab as r,Bb as a,Cb as f,Db as M,Eb as b,G as X,Gb as Q,Jb as C,L as Y,Lb as d,M as v,Pb as W,Qb as J,Rb as K,Sb as ie,Tb as s,Ub as ne,Vb as y,W as G,Wa as te,Yb as I,Za as m,_a as g,aa as Z,fa as ee,j as w,la as E,pb as c,rb as _,va as D,wa as T,wb as p}from"./chunk-RF7UUZCQ.js";var U=(()=>{class t{static{this.baseUrl="api/users"}static get BaseUrl(){return this.baseUrl}static get CreateUrl(){return`${this.baseUrl}/create`}static get UpdateUrl(){return`${this.baseUrl}/update`}static get DeleteUrl(){return`${this.baseUrl}/delete`}}return t})();var H=(()=>{class t{constructor(e){this.coreRequest=e}getUsers(e,n,i,o,u){let h={};return h.page=e??1,h.per_page=n??10,i&&(h.search=i),o&&(h.sort=o),u&&(h.order=u),this.coreRequest.get(U.BaseUrl,h)}getUser(e){return this.coreRequest.get(`${U.BaseUrl}/${e}`)}createUser(e){return this.coreRequest.post(e,U.CreateUrl)}updateUser(e){return this.coreRequest.put(e,U.UpdateUrl)}deleteUser(e){let n={id:e};return this.coreRequest.delete(n,U.DeleteUrl)}static{this.\u0275fac=function(n){return new(n||t)(ee(ae))}}static{this.\u0275prov=Z({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function tt(t,l){t&1&&(r(0,"span"),s(1,"First name is required"),a())}function it(t,l){if(t&1&&(r(0,"mat-error"),c(1,tt,2,0,"span"),a()),t&2){let e,n=d();m(),p(1,!((e=n.form.get("fname"))==null||e.errors==null)&&e.errors.required?1:-1)}}function nt(t,l){t&1&&(r(0,"span"),s(1,"Last name is required"),a())}function rt(t,l){if(t&1&&(r(0,"mat-error"),c(1,nt,2,0,"span"),a()),t&2){let e,n=d();m(),p(1,!((e=n.form.get("lname"))==null||e.errors==null)&&e.errors.required?1:-1)}}function at(t,l){t&1&&(r(0,"span"),s(1,"Email is required"),a())}function ot(t,l){t&1&&(r(0,"span"),s(1,"Invalid email format"),a())}function lt(t,l){if(t&1&&(r(0,"mat-error"),c(1,at,2,0,"span")(2,ot,2,0,"span"),a()),t&2){let e,n,i=d();m(),p(1,!((e=i.form.get("email"))==null||e.errors==null)&&e.errors.required?1:-1),m(),p(2,!((n=i.form.get("email"))==null||n.errors==null)&&n.errors.email?2:-1)}}function st(t,l){t&1&&(r(0,"span"),s(1,"Username is required"),a())}function mt(t,l){if(t&1&&(r(0,"mat-error"),c(1,st,2,0,"span"),a()),t&2){let e,n=d();m(),p(1,!((e=n.form.get("username"))==null||e.errors==null)&&e.errors.required?1:-1)}}function ct(t,l){t&1&&f(0,"mat-spinner",14)}function dt(t,l){if(t&1&&s(0),t&2){let e=d();y(" ",e.type==="create"?"Create":"Update"," ")}}var Qe=(()=>{class t{constructor(e,n,i,o,u){this.fb=e,this.usersService=n,this.notification=i,this.dialogRef=o,this.isLoading=!1,this.type="create",this.destroy$=new w,this.type=u?.type||"create",this.user=u?.user,this.form=this.initForm(this.user)}initForm(e){return this.fb.group({fname:[e?.fname??"",[x.required,x.minLength(2)]],lname:[e?.lname??"",[x.required,x.minLength(2)]],username:[e?.username??"",[x.required,x.minLength(3)]],email:[e?.email??"",[x.required,x.email]]})}onSubmit(){if(this.form.valid){let e=this.form.value;this.type==="create"?(e.avatar="https://www.melivecode.com/users/cat.png",this.createUser(e)):(e.id=this.user?.id,this.updateUser(e))}else this.markFormGroupTouched(this.form)}createUser(e){this.isLoading=!0,this.usersService.createUser(e).pipe(G(this.destroy$),v(()=>this.isLoading=!1)).subscribe({next:()=>{this.notification.success("User created successfully"),this.dialogRef.close(!0)},error:n=>{let i=n?.error?.message;this.notification.error(i)}})}updateUser(e){this.isLoading=!0,this.usersService.updateUser(e).pipe(G(this.destroy$),v(()=>this.isLoading=!1)).subscribe({next:()=>{this.notification.success("User updated successfully"),this.dialogRef.close(!0)},error:n=>{let i=n?.error?.message||"Failed to update user";this.notification.error(i)}})}markFormGroupTouched(e){Object.values(e.controls).forEach(n=>{n.markAsTouched(),n instanceof ce&&this.markFormGroupTouched(n)})}onCancel(){this.dialogRef.close(!1)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static{this.\u0275fac=function(n){return new(n||t)(g(_e),g(H),g(k),g(qe),g(ze,8))}}static{this.\u0275cmp=E({type:t,selectors:[["app-create-edit-user"]],standalone:!0,features:[I],decls:36,vars:10,consts:[[1,"flex","items-center","justify-between","py-2","px-4","border-b","border-lavenderMist"],[1,"text-ebonyClay","font-medium","text-base"],["mat-icon-button","",1,"close-icon",3,"click","disabled"],[1,"px-4","py-6"],[1,"w-full","md:w-96","flex","flex-col","items-center","justify-center",3,"formGroup"],[1,"flex","flex-col","md:flex-row","md:gap-4","w-full"],[1,"w-full"],["matInput","","type","text","formControlName","fname","placeholder","Enter your first name"],["matInput","","type","text","formControlName","lname","placeholder","Enter your last name"],["matInput","","type","email","formControlName","email","placeholder","Enter your email"],["matInput","","type","text","formControlName","username","placeholder","Enter your username"],[1,"flex","items-center","justify-end","gap-4","py-4","px-6","border","border-t","border-lavenderMist"],["mat-raised-button","",1,"discard-button",3,"click","disabled"],["mat-raised-button","",1,"confirm-button",3,"click","disabled"],["strokeWidth","10",1,"form-spinner"]],template:function(n,i){if(n&1&&(r(0,"div")(1,"div",0)(2,"div",1),s(3),a(),r(4,"button",2),C("click",function(){return i.onCancel()}),r(5,"mat-icon"),s(6,"close"),a()()(),r(7,"div",3)(8,"form",4)(9,"div",5)(10,"mat-form-field",6)(11,"mat-label"),s(12,"First Name"),a(),f(13,"input",7),c(14,it,2,1,"mat-error"),a(),r(15,"mat-form-field",6)(16,"mat-label"),s(17,"Last Name"),a(),f(18,"input",8),c(19,rt,2,1,"mat-error"),a()(),r(20,"mat-form-field",6)(21,"mat-label"),s(22,"Email"),a(),f(23,"input",9),c(24,lt,3,2,"mat-error"),a(),r(25,"mat-form-field",6)(26,"mat-label"),s(27,"Username"),a(),f(28,"input",10),c(29,mt,2,1,"mat-error"),a()()(),r(30,"div",11)(31,"button",12),C("click",function(){return i.onCancel()}),s(32,"Cancel"),a(),r(33,"button",13),C("click",function(){return i.onSubmit()}),c(34,ct,1,0,"mat-spinner",14)(35,dt,1,1),a()()()),n&2){let o,u,h,S;m(3),ne(i.type==="create"?"Create User":"Update User"),m(),_("disabled",i.isLoading),m(4),_("formGroup",i.form),m(6),p(14,(o=i.form.get("fname"))!=null&&o.invalid&&((o=i.form.get("fname"))!=null&&o.dirty||(o=i.form.get("fname"))!=null&&o.touched)?14:-1),m(5),p(19,(u=i.form.get("lname"))!=null&&u.invalid&&((u=i.form.get("lname"))!=null&&u.dirty||(u=i.form.get("lname"))!=null&&u.touched)?19:-1),m(5),p(24,(h=i.form.get("email"))!=null&&h.invalid&&((h=i.form.get("email"))!=null&&h.dirty||(h=i.form.get("email"))!=null&&h.touched)?24:-1),m(5),p(29,(S=i.form.get("username"))!=null&&S.invalid&&((S=i.form.get("username"))!=null&&S.dirty||(S=i.form.get("username"))!=null&&S.touched)?29:-1),m(2),_("disabled",i.isLoading),m(2),_("disabled",i.form.invalid||i.isLoading),m(),p(34,i.isLoading?34:35)}},dependencies:[ge,ue,q,z,me,pe,fe,B,V,P,oe,le,N,O,j,R,F,L,Be,Ve],styles:["[_nghost-%COMP%]     .form-spinner{width:20px!important;height:20px!important}[_nghost-%COMP%]     .form-spinner .mdc-circular-progress__indeterminate-circle-graphic{stroke:#153e66}"]})}}return t})();function ut(t,l){t&1&&(r(0,"mat-header-cell",22),s(1," Avatar "),a())}function pt(t,l){if(t&1&&f(0,"img",23),t&2){let e=d().$implicit;_("src",e.avatar,te)}}function ft(t,l){t&1&&f(0,"div",24)}function _t(t,l){if(t&1&&(r(0,"mat-cell",22),c(1,pt,1,1,"img",23)(2,ft,1,0),a()),t&2){let e=d();m(),p(1,e.isLoading?2:1)}}function ht(t,l){if(t&1){let e=Q();r(0,"mat-header-cell")(1,"mat-form-field",25)(2,"input",26),C("ngModelChange",function(i){D(e);let o=d();return T(o.onSearchChange(i))}),a(),r(3,"div",27)(4,"div")(5,"mat-icon"),s(6,"search"),a()(),r(7,"div",28)(8,"mat-icon"),s(9,"sort_by_alpha"),a()()()()()}if(t&2){let e=d();m(2),_("ngModel",e.nameSearch)}}function gt(t,l){if(t&1&&s(0),t&2){let e=d().$implicit;y(" ",e.fname+" "+e.lname," ")}}function Ct(t,l){t&1&&f(0,"div",29)}function xt(t,l){if(t&1&&(r(0,"mat-cell"),c(1,gt,1,1)(2,Ct,1,0),a()),t&2){let e=d();m(),p(1,e.isLoading?2:1)}}function St(t,l){t&1&&(r(0,"mat-header-cell",30),s(1," Username "),a())}function vt(t,l){if(t&1&&s(0),t&2){let e=d().$implicit;y(" ",e.username," ")}}function Ut(t,l){t&1&&f(0,"div",31)}function Mt(t,l){if(t&1&&(r(0,"mat-cell"),c(1,vt,1,1)(2,Ut,1,0),a()),t&2){let e=d();m(),p(1,e.isLoading?2:1)}}function bt(t,l){t&1&&f(0,"mat-header-cell",32)}function yt(t,l){if(t&1){let e=Q();r(0,"button",33)(1,"mat-icon"),s(2,"more_vert"),a()(),r(3,"mat-menu",34,0)(5,"button",35),C("click",function(){D(e);let i=d().$implicit,o=d();return T(o.userDialog("edit",i))}),r(6,"mat-icon"),s(7,"edit"),a(),r(8,"span"),s(9,"Edit"),a()(),r(10,"button",35),C("click",function(){D(e);let i=d().$implicit,o=d();return T(o.confirmDelete(i))}),r(11,"mat-icon",36),s(12,"delete"),a(),r(13,"span",37),s(14,"Delete"),a()()()}if(t&2){let e=ie(4);_("matMenuTriggerFor",e)}}function wt(t,l){t&1&&f(0,"div",38)}function Et(t,l){if(t&1&&(r(0,"mat-cell",32),c(1,yt,15,1)(2,wt,1,0),a()),t&2){let e=d();m(),p(1,e.isLoading?2:1)}}function Dt(t,l){t&1&&f(0,"mat-header-row")}function Tt(t,l){t&1&&f(0,"mat-row")}function It(t,l){t&1&&(r(0,"tr")(1,"td")(2,"div",39),f(3,"img",40),r(4,"span",41),s(5,"No data matching the filter"),a()()()())}var mi=(()=>{class t{constructor(e,n,i,o){this.usersService=e,this.notification=n,this.paginatorIntl=i,this.dialog=o,this.displayedColumns=["avatar","name","username","actions"],this.isLoading=!1,this.users=[],this.total=0,this.currentPage=1,this.pageSize=10,this.pageSizeOptions=[5,10,25,50],this.sortColumn="",this.sortOrder="asc",this.isEmpty=!1,this.nameSearch="",this.searchSubject=new w,this.skeletonData=Array(10).fill({avatar:"",fname:"",lname:"",username:""}),this.paginatorIntl.itemsPerPageLabel="Items per page:",this.searchSubject.pipe(X(300),Y()).subscribe(u=>{this.nameSearch=u,this.currentPage=1,this.paginator&&this.paginator.firstPage(),this.getUsers()})}ngOnInit(){this.getUsers()}pageEvent(e){this.currentPage=e.pageIndex+1,this.pageSize=e.pageSize,this.getUsers()}sortData(e){!e.active||e.direction===""?(this.sortColumn="",this.sortOrder="asc"):(this.sortColumn=e.active,this.sortOrder=e.direction),this.getUsers()}getUsers(){this.isLoading=!0,this.usersService.getUsers(this.currentPage,this.pageSize,this.nameSearch,this.sortColumn,this.sortOrder).pipe(v(()=>{this.isLoading=!1})).subscribe({next:e=>{e&&(this.users=e.data,this.dataSource=new ke(this.users),this.total=e.total,this.isEmpty=this.users.length>=10)},error:e=>{let n=e?.error?.message;this.notification.error(n)}})}userDialog(e,n){this.dialog.open(Qe,{data:{type:e,user:n},panelClass:"create-edit-user-dialog"}).afterClosed().subscribe(o=>{o&&this.getUsers()})}confirmDelete(e){this.dialog.open(Ae,{data:{title:"Delete User",message:"Are you sure you want to delete this user?"},panelClass:"confirmation-dialog"}).afterClosed().subscribe(i=>{i&&this.deleteUser(e)})}deleteUser(e){this.isLoading=!0,this.usersService.deleteUser(e.id).pipe(v(()=>{this.isLoading=!1})).subscribe({next:()=>{this.notification.success(`${e.fname} ${e.lname} deleted successfully`),this.getUsers()},error:n=>{let i=n?.error?.message;this.notification.error(i)}})}onSearchChange(e){this.searchSubject.next(e)}static{this.\u0275fac=function(n){return new(n||t)(g(H),g(k),g(Ce),g($e))}}static{this.\u0275cmp=E({type:t,selectors:[["app-users"]],viewQuery:function(n,i){if(n&1&&(W($,5),W(A,5)),n&2){let o;J(o=K())&&(i.paginator=o.first),J(o=K())&&(i.sort=o.first)}},standalone:!0,features:[I],decls:27,vars:10,consts:[["menu","matMenu"],["actions","",1,"flex","items-center"],["mat-button","",1,"action-button",3,"click"],[1,"w-full","relative"],[1,"overflow-x-auto","w-full",2,"max-width","calc(100vw - 32px)"],[1,"mat-elevation-z8","min-w-[1000px]"],["matSort","",3,"matSortChange","dataSource","matSortActive","matSortDirection"],["matColumnDef","avatar",3,"sticky"],["class","!w-40 !max-w-40",4,"matHeaderCellDef"],["class","!w-40 !max-w-40",4,"matCellDef"],["matColumnDef","name"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","username"],["mat-sort-header","username",4,"matHeaderCellDef"],["matColumnDef","actions"],["class","!w-20 !max-w-20 justify-center",4,"matHeaderCellDef"],["class","!w-20 !max-w-20 justify-center",4,"matCellDef"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[4,"matNoDataRow"],["aria-label","Select page",3,"page","length","pageSize","pageSizeOptions","showFirstLastButtons"],[1,"!w-40","!max-w-40"],["alt","user avatar","loading","lazy",1,"w-10","h-10","rounded-full",3,"src"],[1,"w-10","h-10","rounded-full","bg-gray-200","animate-pulse"],[1,"search-input","max-w-40"],["matInput","","placeholder","Name",3,"ngModelChange","ngModel"],["matSuffix","",1,"flex","items-center","gap-2"],["mat-sort-header","name","arrowPosition","after"],[1,"h-4","bg-gray-200","rounded","w-32","animate-pulse"],["mat-sort-header","username"],[1,"h-4","bg-gray-200","rounded","w-24","animate-pulse"],[1,"!w-20","!max-w-20","justify-center"],["mat-icon-button","",3,"matMenuTriggerFor"],[1,"-mt-5"],["mat-menu-item","",3,"click"],[1,"!text-cardinal"],[1,"text-cardinal"],[1,"h-8","w-8","bg-gray-200","rounded-full","animate-pulse"],[1,"w-screen","max-w-[100vh]","min-h-[500px]","flex","flex-col","items-center","justify-center"],["src","assets/images/empty-data.png","alt","No data",1,"w-64"],[1,"text-cardinal","font-medium","text-base","mt-4"]],template:function(n,i){n&1&&(r(0,"app-container")(1,"div",1)(2,"button",2),C("click",function(){return i.userDialog("create")}),r(3,"mat-icon"),s(4,"add"),a(),r(5,"span"),s(6,"Add User"),a()()(),r(7,"div",3)(8,"div",4)(9,"div",5)(10,"mat-table",6),C("matSortChange",function(u){return i.sortData(u)}),M(11,7),c(12,ut,2,0,"mat-header-cell",8)(13,_t,3,1,"mat-cell",9),b(),M(14,10),c(15,ht,10,1,"mat-header-cell",11)(16,xt,3,1,"mat-cell",12),b(),M(17,13),c(18,St,2,0,"mat-header-cell",14)(19,Mt,3,1,"mat-cell",12),b(),M(20,15),c(21,bt,1,0,"mat-header-cell",16)(22,Et,3,1,"mat-cell",17),b(),c(23,Dt,1,0,"mat-header-row",18)(24,Tt,1,0,"mat-row",19)(25,It,6,0,"tr",20),a(),r(26,"mat-paginator",21),C("page",function(u){return i.pageEvent(u)}),a()()()()()),n&2&&(m(10),_("dataSource",i.isLoading?i.skeletonData:i.dataSource)("matSortActive",i.sortColumn)("matSortDirection",i.sortOrder),m(),_("sticky",!1),m(12),_("matHeaderRowDef",i.displayedColumns),m(),_("matRowDefColumns",i.displayedColumns),m(2),_("length",i.total)("pageSize",i.pageSize)("pageSizeOptions",i.pageSizeOptions)("showFirstLastButtons",!0))},dependencies:[he,q,z,de,R,F,L,O,j,Re,Ue,be,De,ye,Me,Te,we,Ee,Ie,Fe,Le,xe,$,ve,A,Se,N,P,se,B,V,Ne,Oe,je,Pe,re],styles:["[_nghost-%COMP%]     .search-input{padding-bottom:1rem}[_nghost-%COMP%]     .search-input .mdc-text-field--filled{height:50px}[_nghost-%COMP%]     .search-input .mat-mdc-form-field-subscript-wrapper{display:none}[_nghost-%COMP%]     .search-input .mat-icon{width:20px!important;height:20px!important}[_nghost-%COMP%]     .search-input .material-icons{font-size:20px!important}.mat-mdc-table[_ngcontent-%COMP%]{width:100%}"]})}}return t})();export{mi as a};
